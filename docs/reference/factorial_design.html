<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Build Factorial Designs for ANOVA — factorial_design • rstatix</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  
  <script src="../extra.js"></script>

<meta property="og:title" content="Build Factorial Designs for ANOVA — factorial_design" />
<meta property="og:description" content="Provides helper functions to build factorial design for easily
 computing ANOVA using the Anova() function. This might be
 very useful for repeated measures ANOVA, which is hard to set up with the
 car package." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rstatix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kassambara/rstatix/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Build Factorial Designs for ANOVA</h1>
    <small class="dont-index">Source: <a href='https://github.com/kassambara/rstatix/blob/master/R/factorial_design.R'><code>R/factorial_design.R</code></a></small>
    <div class="hidden name"><code>factorial_design.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Provides helper functions to build factorial design for easily
 computing ANOVA using the <code><a href='https://rdrr.io/pkg/car/man/Anova.html'>Anova</a>()</code> function. This might be
 very useful for repeated measures ANOVA, which is hard to set up with the
 <code>car</code> package.</p>
    </div>

    <pre class="usage"><span class='fu'>factorial_design</span>(<span class='no'>data</span>, <span class='no'>dv</span>, <span class='no'>wid</span>, <span class='no'>between</span>, <span class='no'>within</span>, <span class='no'>covariate</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>a data frame containing the variables</p></td>
    </tr>
    <tr>
      <th>dv</th>
      <td><p>(numeric) dependent variable name.</p></td>
    </tr>
    <tr>
      <th>wid</th>
      <td><p>(factor) column name containing individuals/subjects identifier.
Should be unique per individual.</p></td>
    </tr>
    <tr>
      <th>between</th>
      <td><p>(optional) between-subject factor variables.</p></td>
    </tr>
    <tr>
      <th>within</th>
      <td><p>(optional) within-subjects factor variables</p></td>
    </tr>
    <tr>
      <th>covariate</th>
      <td><p>(optional) covariate names (for ANCOVA)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list with the following components:</p><ul>
<li><p><strong>the
 specified arguments</strong>: <code>dv, wid, between, within</code></p></li>
<li><p><strong>data</strong>:
 the original data (long format) or independent ANOVA. The wide format is
 returned for repeated measures ANOVA.</p></li>
<li><p><strong>idata</strong>: an optional data
 frame giving the levels of factors defining the intra-subject model for
 multivariate repeated-measures data.</p></li>
<li><p><strong>idesign</strong>: a one-sided
 model formula using the “data” in idata and specifying the intra-subject
 design.</p></li>
<li><p><strong>repeated</strong>: logical. Value is TRUE when the data is a
 repeated design.</p></li>
<li><p><strong>lm_formula</strong>: the formula used to build the
 <code>lm</code> model.</p></li>
<li><p><strong>lm_data</strong>: the data used to build the <code>lm</code>
 model. Can be either in a long format (i.e., the original data for
 independent measures ANOVA) or in a wide format (case of repeated measures ANOVA).</p></li>
<li><p><strong>model</strong>: the <code>lm</code> model</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='anova_test.html'>anova_test</a>()</code>, <code><a href='anova_summary.html'>anova_summary</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Load data</span>
<span class='co'>#:::::::::::::::::::::::::::::::::::::::</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"ToothGrowth"</span>)
<span class='no'>df</span> <span class='kw'>&lt;-</span> <span class='no'>ToothGrowth</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>df</span>)</div><div class='output co'>#&gt;    len supp dose
#&gt; 1  4.2   VC  0.5
#&gt; 2 11.5   VC  0.5
#&gt; 3  7.3   VC  0.5
#&gt; 4  5.8   VC  0.5
#&gt; 5  6.4   VC  0.5
#&gt; 6 10.0   VC  0.5</div><div class='input'>
<span class='co'># Repeated measures designs</span>
<span class='co'>#:::::::::::::::::::::::::::::::::::::::::</span>
<span class='co'># Prepare the data</span>
<span class='no'>df</span>$<span class='no'>id</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>10</span>, <span class='fl'>6</span>) <span class='co'># Add individuals id</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>df</span>)</div><div class='output co'>#&gt;    len supp dose id
#&gt; 1  4.2   VC  0.5  1
#&gt; 2 11.5   VC  0.5  2
#&gt; 3  7.3   VC  0.5  3
#&gt; 4  5.8   VC  0.5  4
#&gt; 5  6.4   VC  0.5  5
#&gt; 6 10.0   VC  0.5  6</div><div class='input'><span class='co'># Build factorial designs</span>
<span class='no'>design</span> <span class='kw'>&lt;-</span> <span class='fu'>factorial_design</span>(<span class='no'>df</span>, <span class='kw'>dv</span> <span class='kw'>=</span> <span class='no'>len</span>, <span class='kw'>wid</span> <span class='kw'>=</span> <span class='no'>id</span>, <span class='kw'>within</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>supp</span>, <span class='no'>dose</span>))
<span class='no'>design</span></div><div class='output co'>#&gt; $dv
#&gt; [1] "len"
#&gt; 
#&gt; $wid
#&gt; [1] "id"
#&gt; 
#&gt; $within
#&gt; [1] "supp" "dose"
#&gt; 
#&gt; $data
#&gt; # A tibble: 60 x 4
#&gt;      len supp  dose  id   
#&gt;    &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
#&gt;  1   4.2 VC    X0.5  1    
#&gt;  2  11.5 VC    X0.5  2    
#&gt;  3   7.3 VC    X0.5  3    
#&gt;  4   5.8 VC    X0.5  4    
#&gt;  5   6.4 VC    X0.5  5    
#&gt;  6  10   VC    X0.5  6    
#&gt;  7  11.2 VC    X0.5  7    
#&gt;  8  11.2 VC    X0.5  8    
#&gt;  9   5.2 VC    X0.5  9    
#&gt; 10   7   VC    X0.5  10   
#&gt; # … with 50 more rows
#&gt; 
#&gt; $idata
#&gt;   supp dose
#&gt; 1   OJ X0.5
#&gt; 2   OJ   X1
#&gt; 3   OJ   X2
#&gt; 4   VC X0.5
#&gt; 5   VC   X1
#&gt; 6   VC   X2
#&gt; 
#&gt; $idesign
#&gt; ~supp * dose
#&gt; &lt;environment: 0x7fa9b991e138&gt;
#&gt; 
#&gt; $lm_data
#&gt; # A tibble: 10 x 7
#&gt;    id    OJ_X0.5 OJ_X1 OJ_X2 VC_X0.5 VC_X1 VC_X2
#&gt;    &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt;  1 1        15.2  19.7  25.5     4.2  16.5  23.6
#&gt;  2 2        21.5  23.3  26.4    11.5  16.5  18.5
#&gt;  3 3        17.6  23.6  22.4     7.3  15.2  33.9
#&gt;  4 4         9.7  26.4  24.5     5.8  17.3  25.5
#&gt;  5 5        14.5  20    24.8     6.4  22.5  26.4
#&gt;  6 6        10    25.2  30.9    10    17.3  32.5
#&gt;  7 7         8.2  25.8  26.4    11.2  13.6  26.7
#&gt;  8 8         9.4  21.2  27.3    11.2  14.5  21.5
#&gt;  9 9        16.5  14.5  29.4     5.2  18.8  23.3
#&gt; 10 10        9.7  27.3  23       7    15.5  29.5
#&gt; 
#&gt; $repeated
#&gt; [1] TRUE
#&gt; 
#&gt; $lm_formula
#&gt; cbind(OJ_X0.5, OJ_X1, OJ_X2, VC_X0.5, VC_X1, VC_X2) ~ 1
#&gt; &lt;environment: 0x7fa9d750da40&gt;
#&gt; 
#&gt; $model
#&gt; 
#&gt; Call:
#&gt; stats::lm(formula = lm_formula, data = data)
#&gt; 
#&gt; Coefficients:
#&gt;              OJ_X0.5  OJ_X1  OJ_X2  VC_X0.5  VC_X1  VC_X2
#&gt; (Intercept)  13.23    22.70  26.06   7.98    16.77  26.14
#&gt; 
#&gt; </div><div class='input'><span class='co'># Easily perform repeated measures ANOVA using the car package</span>
<span class='no'>res.anova</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/car/man/Anova.html'>Anova</a></span>(<span class='no'>design</span>$<span class='no'>model</span>, <span class='kw'>idata</span> <span class='kw'>=</span> <span class='no'>design</span>$<span class='no'>idata</span>, <span class='kw'>idesign</span> <span class='kw'>=</span> <span class='no'>design</span>$<span class='no'>idesign</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>res.anova</span>, <span class='kw'>multivariate</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: HF eps &gt; 1 treated as 1</span></div><div class='output co'>#&gt; 
#&gt; Univariate Type III Repeated-Measures ANOVA Assuming Sphericity
#&gt; 
#&gt;              Sum Sq num Df Error SS den Df   F value    Pr(&gt;F)    
#&gt; (Intercept) 21236.5      1    69.33      9 2756.9514 1.656e-12 ***
#&gt; supp          205.3      1    53.01      9   34.8664 0.0002277 ***
#&gt; dose         2426.4      2   205.11     18  106.4698 1.062e-10 ***
#&gt; supp:dose     108.3      2   384.66     18    2.5343 0.1072129    
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; 
#&gt; Mauchly Tests for Sphericity
#&gt; 
#&gt;           Test statistic p-value
#&gt; dose             0.80739 0.42495
#&gt; supp:dose        0.93390 0.76068
#&gt; 
#&gt; 
#&gt; Greenhouse-Geisser and Huynh-Feldt Corrections
#&gt;  for Departure from Sphericity
#&gt; 
#&gt;           GG eps Pr(&gt;F[GG])    
#&gt; dose      0.8385   2.79e-09 ***
#&gt; supp:dose 0.9380     0.1115    
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt;             HF eps   Pr(&gt;F[HF])
#&gt; dose      1.008462 1.061617e-10
#&gt; supp:dose 1.176302 1.072129e-01</div><div class='input'>
<span class='co'># Independent measures designs</span>
<span class='co'>#:::::::::::::::::::::::::::::::::::::::::</span>
<span class='co'># Build factorial designs</span>
<span class='no'>df</span>$<span class='no'>id</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>:<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>df</span>)
<span class='no'>design</span> <span class='kw'>&lt;-</span> <span class='fu'>factorial_design</span>(<span class='no'>df</span>, <span class='kw'>dv</span> <span class='kw'>=</span> <span class='no'>len</span>, <span class='kw'>wid</span> <span class='kw'>=</span> <span class='no'>id</span>, <span class='kw'>between</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>supp</span>, <span class='no'>dose</span>))
<span class='no'>design</span></div><div class='output co'>#&gt; $dv
#&gt; [1] "len"
#&gt; 
#&gt; $between
#&gt; [1] "supp" "dose"
#&gt; 
#&gt; $wid
#&gt; [1] "id"
#&gt; 
#&gt; $data
#&gt; # A tibble: 60 x 4
#&gt;      len supp  dose  id   
#&gt;    &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
#&gt;  1   4.2 VC    0.5   1    
#&gt;  2  11.5 VC    0.5   2    
#&gt;  3   7.3 VC    0.5   3    
#&gt;  4   5.8 VC    0.5   4    
#&gt;  5   6.4 VC    0.5   5    
#&gt;  6  10   VC    0.5   6    
#&gt;  7  11.2 VC    0.5   7    
#&gt;  8  11.2 VC    0.5   8    
#&gt;  9   5.2 VC    0.5   9    
#&gt; 10   7   VC    0.5   10   
#&gt; # … with 50 more rows
#&gt; 
#&gt; $lm_data
#&gt; # A tibble: 60 x 4
#&gt;      len supp  dose  id   
#&gt;    &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
#&gt;  1   4.2 VC    0.5   1    
#&gt;  2  11.5 VC    0.5   2    
#&gt;  3   7.3 VC    0.5   3    
#&gt;  4   5.8 VC    0.5   4    
#&gt;  5   6.4 VC    0.5   5    
#&gt;  6  10   VC    0.5   6    
#&gt;  7  11.2 VC    0.5   7    
#&gt;  8  11.2 VC    0.5   8    
#&gt;  9   5.2 VC    0.5   9    
#&gt; 10   7   VC    0.5   10   
#&gt; # … with 50 more rows
#&gt; 
#&gt; $repeated
#&gt; [1] FALSE
#&gt; 
#&gt; $lm_formula
#&gt; len ~ supp * dose
#&gt; &lt;environment: 0x7fa9bb302108&gt;
#&gt; 
#&gt; $model
#&gt; 
#&gt; Call:
#&gt; stats::lm(formula = lm_formula, data = data)
#&gt; 
#&gt; Coefficients:
#&gt; (Intercept)        supp1        dose1        dose2  supp1:dose1  supp1:dose2  
#&gt;     18.8133       1.8500      -8.2083       0.9217       0.7750       1.1150  
#&gt; 
#&gt; </div><div class='input'><span class='co'># Perform ANOVA</span>
<span class='fu'><a href='https://rdrr.io/pkg/car/man/Anova.html'>Anova</a></span>(<span class='no'>design</span>$<span class='no'>model</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>3</span>)</div><div class='output co'>#&gt; Anova Table (Type III tests)
#&gt; 
#&gt; Response: len
#&gt;              Sum Sq Df  F value    Pr(&gt;F)    
#&gt; (Intercept) 21236.5  1 1610.393 &lt; 2.2e-16 ***
#&gt; supp          205.4  1   15.572 0.0002312 ***
#&gt; dose         2426.4  2   92.000 &lt; 2.2e-16 ***
#&gt; supp:dose     108.3  2    4.107 0.0218603 *  
#&gt; Residuals     712.1 54                       
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alboukadel Kassambara.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


