<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Build Factorial Designs for ANOVA — factorial_design • rstatix</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Build Factorial Designs for ANOVA — factorial_design"><meta property="og:description" content="Provides helper functions to build factorial design for easily
 computing ANOVA using the Anova() function. This might be
 very useful for repeated measures ANOVA, which is hard to set up with the
 car package."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rstatix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.7.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/kassambara/rstatix/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Build Factorial Designs for ANOVA</h1>
    <small class="dont-index">Source: <a href="https://github.com/kassambara/rstatix/blob/HEAD/R/factorial_design.R" class="external-link"><code>R/factorial_design.R</code></a></small>
    <div class="hidden name"><code>factorial_design.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Provides helper functions to build factorial design for easily
 computing ANOVA using the <code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a>()</code> function. This might be
 very useful for repeated measures ANOVA, which is hard to set up with the
 <code>car</code> package.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">factorial_design</span><span class="op">(</span><span class="va">data</span>, <span class="va">dv</span>, <span class="va">wid</span>, <span class="va">between</span>, <span class="va">within</span>, <span class="va">covariate</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>a data frame containing the variables</p></dd>


<dt>dv</dt>
<dd><p>(numeric) dependent variable name.</p></dd>


<dt>wid</dt>
<dd><p>(factor) column name containing individuals/subjects identifier.
Should be unique per individual.</p></dd>


<dt>between</dt>
<dd><p>(optional) between-subject factor variables.</p></dd>


<dt>within</dt>
<dd><p>(optional) within-subjects factor variables</p></dd>


<dt>covariate</dt>
<dd><p>(optional) covariate names (for ANCOVA)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a list with the following components:</p><ul><li><p><strong>the
 specified arguments</strong>: <code>dv, wid, between, within</code></p></li>
<li><p><strong>data</strong>:
 the original data (long format) or independent ANOVA. The wide format is
 returned for repeated measures ANOVA.</p></li>
<li><p><strong>idata</strong>: an optional data
 frame giving the levels of factors defining the intra-subject model for
 multivariate repeated-measures data.</p></li>
<li><p><strong>idesign</strong>: a one-sided
 model formula using the “data” in idata and specifying the intra-subject
 design.</p></li>
<li><p><strong>repeated</strong>: logical. Value is TRUE when the data is a
 repeated design.</p></li>
<li><p><strong>lm_formula</strong>: the formula used to build the
 <code>lm</code> model.</p></li>
<li><p><strong>lm_data</strong>: the data used to build the <code>lm</code>
 model. Can be either in a long format (i.e., the original data for
 independent measures ANOVA) or in a wide format (case of repeated measures ANOVA).</p></li>
<li><p><strong>model</strong>: the <code>lm</code> model</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="anova_test.html">anova_test</a>()</code>, <code><a href="anova_summary.html">anova_summary</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Alboukadel Kassambara, <a href="mailto:alboukadel.kassambara@gmail.com">alboukadel.kassambara@gmail.com</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load data</span></span></span>
<span class="r-in"><span><span class="co">#:::::::::::::::::::::::::::::::::::::::</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ToothGrowth"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">ToothGrowth</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    len supp dose</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  4.2   VC  0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 11.5   VC  0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  7.3   VC  0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  5.8   VC  0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  6.4   VC  0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 10.0   VC  0.5</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Repeated measures designs</span></span></span>
<span class="r-in"><span><span class="co">#:::::::::::::::::::::::::::::::::::::::::</span></span></span>
<span class="r-in"><span><span class="co"># Prepare the data</span></span></span>
<span class="r-in"><span><span class="va">df</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">6</span><span class="op">)</span> <span class="co"># Add individuals id</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    len supp dose id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  4.2   VC  0.5  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 11.5   VC  0.5  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  7.3   VC  0.5  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  5.8   VC  0.5  4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  6.4   VC  0.5  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 10.0   VC  0.5  6</span>
<span class="r-in"><span><span class="co"># Build factorial designs</span></span></span>
<span class="r-in"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu">factorial_design</span><span class="op">(</span><span class="va">df</span>, dv <span class="op">=</span> <span class="va">len</span>, wid <span class="op">=</span> <span class="va">id</span>, within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">supp</span>, <span class="va">dose</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">design</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "len"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "id"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $within</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "supp" "dose"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 60 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      len supp  dose  id   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>   4.2 VC    X0.5  1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>  11.5 VC    X0.5  2    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>   7.3 VC    X0.5  3    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>   5.8 VC    X0.5  4    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>   6.4 VC    X0.5  5    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>  10   VC    X0.5  6    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>  11.2 VC    X0.5  7    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>  11.2 VC    X0.5  8    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>   5.2 VC    X0.5  9    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>   7   VC    X0.5  10   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 50 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $idata</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   supp dose</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   OJ X0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   OJ   X1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   OJ   X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   VC X0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   VC   X1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   VC   X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $idesign</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ~supp * dose</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x7fb8b3117708&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lm_data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 10 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id    OJ_X0.5 OJ_X1 OJ_X2 VC_X0.5 VC_X1 VC_X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 1        15.2  19.7  25.5     4.2  16.5  23.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 2        21.5  23.3  26.4    11.5  16.5  18.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 3        17.6  23.6  22.4     7.3  15.2  33.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 4         9.7  26.4  24.5     5.8  17.3  25.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 5        14.5  20    24.8     6.4  22.5  26.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 6        10    25.2  30.9    10    17.3  32.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 7         8.2  25.8  26.4    11.2  13.6  26.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 8         9.4  21.2  27.3    11.2  14.5  21.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 9        16.5  14.5  29.4     5.2  18.8  23.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 10        9.7  27.3  23       7    15.5  29.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $repeated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lm_formula</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cbind(OJ_X0.5, OJ_X1, OJ_X2, VC_X0.5, VC_X1, VC_X2) ~ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x7fb8a693d6d0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stats::lm(formula = lm_formula, data = data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              OJ_X0.5  OJ_X1  OJ_X2  VC_X0.5  VC_X1  VC_X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  13.23    22.70  26.06   7.98    16.77  26.14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Easily perform repeated measures ANOVA using the car package</span></span></span>
<span class="r-in"><span><span class="va">res.anova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">design</span><span class="op">$</span><span class="va">model</span>, idata <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="va">idata</span>, idesign <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="va">idesign</span>, type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.anova</span>, multivariate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>HF eps &gt; 1 treated as 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Univariate Type III Repeated-Measures ANOVA Assuming Sphericity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Sum Sq num Df Error SS den Df   F value    Pr(&gt;F)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 21236.5      1    69.33      9 2756.9514 1.656e-12 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> supp          205.3      1    53.01      9   34.8664 0.0002277 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dose         2426.4      2   205.11     18  106.4698 1.062e-10 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> supp:dose     108.3      2   384.66     18    2.5343 0.1072129    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mauchly Tests for Sphericity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Test statistic p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dose             0.80739 0.42495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> supp:dose        0.93390 0.76068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Greenhouse-Geisser and Huynh-Feldt Corrections</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  for Departure from Sphericity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           GG eps Pr(&gt;F[GG])    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dose      0.8385   2.79e-09 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> supp:dose 0.9380     0.1115    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             HF eps   Pr(&gt;F[HF])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dose      1.008462 1.061617e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> supp:dose 1.176302 1.072129e-01</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Independent measures designs</span></span></span>
<span class="r-in"><span><span class="co">#:::::::::::::::::::::::::::::::::::::::::</span></span></span>
<span class="r-in"><span><span class="co"># Build factorial designs</span></span></span>
<span class="r-in"><span><span class="va">df</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu">factorial_design</span><span class="op">(</span><span class="va">df</span>, dv <span class="op">=</span> <span class="va">len</span>, wid <span class="op">=</span> <span class="va">id</span>, between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">supp</span>, <span class="va">dose</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">design</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "len"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $between</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "supp" "dose"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "id"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 60 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      len supp  dose  id   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>   4.2 VC    0.5   1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>  11.5 VC    0.5   2    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>   7.3 VC    0.5   3    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>   5.8 VC    0.5   4    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>   6.4 VC    0.5   5    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>  10   VC    0.5   6    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>  11.2 VC    0.5   7    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>  11.2 VC    0.5   8    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>   5.2 VC    0.5   9    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>   7   VC    0.5   10   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 50 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lm_data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 60 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      len supp  dose  id   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>   4.2 VC    0.5   1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>  11.5 VC    0.5   2    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>   7.3 VC    0.5   3    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>   5.8 VC    0.5   4    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>   6.4 VC    0.5   5    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>  10   VC    0.5   6    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>  11.2 VC    0.5   7    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>  11.2 VC    0.5   8    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>   5.2 VC    0.5   9    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>   7   VC    0.5   10   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 50 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $repeated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lm_formula</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> len ~ supp * dose</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x7fb8b65ceb00&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stats::lm(formula = lm_formula, data = data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)        supp1        dose1        dose2  supp1:dose1  supp1:dose2  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     18.8133       1.8500      -8.2083       0.9217       0.7750       1.1150  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Perform ANOVA</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">design</span><span class="op">$</span><span class="va">model</span>, type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Anova Table (Type III tests)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response: len</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Sum Sq Df  F value    Pr(&gt;F)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 21236.5  1 1610.393 &lt; 2.2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> supp          205.4  1   15.572 0.0002312 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dose         2426.4  2   92.000 &lt; 2.2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> supp:dose     108.3  2    4.107 0.0218603 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals     712.1 54                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alboukadel Kassambara.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

