<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Anova Test — anova_test • rstatix</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Anova Test — anova_test"><meta property="og:description" content="Provides a pipe-friendly framework to perform different types of
 ANOVA tests, including:
Independent
 measures ANOVA: between-Subjects designs,
Repeated
  measures ANOVA: within-Subjects designs
Mixed
 ANOVA: Mixed within within- and between-Subjects designs, also known as
 split-plot ANOVA and
ANCOVA:
 Analysis of Covariance.


The function is an easy to use wrapper around Anova() and
 aov(). It makes ANOVA computation handy in R and It's
 highly flexible: can support model and formula as input. Variables can be
 also specified as character vector using the arguments dv, wid,
 between, within, covariate.
The results include ANOVA table, generalized effect size and some assumption
 checks."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rstatix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.7.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/kassambara/rstatix/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Anova Test</h1>
    <small class="dont-index">Source: <a href="https://github.com/kassambara/rstatix/blob/HEAD/R/anova_test.R" class="external-link"><code>R/anova_test.R</code></a></small>
    <div class="hidden name"><code>anova_test.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Provides a pipe-friendly framework to perform different types of
 ANOVA tests, including:</p><ul><li><p><strong><a href="https://www.datanovia.com/en/lessons/anova-in-r/" class="external-link">Independent
 measures ANOVA</a></strong>: between-Subjects designs,</p></li>
<li><p><strong><a href="https://www.datanovia.com/en/lessons/repeated-measures-anova-in-r/" class="external-link">Repeated
  measures ANOVA</a></strong>: within-Subjects designs</p></li>
<li><p><strong><a href="https://www.datanovia.com/en/lessons/mixed-anova-in-r/" class="external-link">Mixed
 ANOVA</a></strong>: Mixed within within- and between-Subjects designs, also known as
 split-plot ANOVA and</p></li>
<li><p><strong><a href="https://www.datanovia.com/en/lessons/ancova-in-r/" class="external-link">ANCOVA:
 Analysis of Covariance</a></strong>.</p></li>
</ul><p>The function is an easy to use wrapper around <code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a>()</code> and
 <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a>()</code>. It makes ANOVA computation handy in R and It's
 highly flexible: can support model and formula as input. Variables can be
 also specified as character vector using the arguments <code>dv, wid,
 between, within, covariate</code>.</p>
<p>The results include ANOVA table, generalized effect size and some assumption
 checks.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">anova_test</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">dv</span>,</span>
<span>  <span class="va">wid</span>,</span>
<span>  <span class="va">between</span>,</span>
<span>  <span class="va">within</span>,</span>
<span>  <span class="va">covariate</span>,</span>
<span>  type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  effect.size <span class="op">=</span> <span class="st">"ges"</span>,</span>
<span>  error <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  white.adjust <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  observed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  detailed <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_anova_table</span><span class="op">(</span><span class="va">x</span>, correction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"GG"</span>, <span class="st">"HF"</span>, <span class="st">"none"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for anova_test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for anova_test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>a data.frame or a model to be analyzed.</p></dd>


<dt>formula</dt>
<dd><p>a formula specifying the ANOVA model similar to
 <a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a>. Can be of the form <code>y ~ group</code> where <code>y</code> is a
 numeric variable giving the data values and <code>group</code> is a factor with
 one or multiple levels giving the corresponding groups. For example,
 <code>formula = TP53 ~ cancer_group</code>.</p>
<p>Examples of supported formula include:</p><ul><li><p>Between-Ss ANOVA
 (independent measures ANOVA): <code>y ~ b1*b2</code></p></li>
<li><p>Within-Ss ANOVA
 (repeated measures ANOVA): <code>y ~ w1*w2 + Error(id/(w1*w2))</code></p></li>
<li><p>Mixed
 ANOVA: <code>y ~ b1*b2*w1 + Error(id/w1)</code></p></li>
</ul><p>If the formula doesn't contain any within vars, a linear model is directly
 fitted and  passed to the ANOVA function. For repeated designs, the ANOVA
 variables are parsed from the formula.</p></dd>


<dt>dv</dt>
<dd><p>(numeric) dependent variable name.</p></dd>


<dt>wid</dt>
<dd><p>(factor) column name containing individuals/subjects identifier.
Should be unique per individual.</p></dd>


<dt>between</dt>
<dd><p>(optional) between-subject factor variables.</p></dd>


<dt>within</dt>
<dd><p>(optional) within-subjects factor variables</p></dd>


<dt>covariate</dt>
<dd><p>(optional) covariate names (for ANCOVA)</p></dd>


<dt>type</dt>
<dd><p>the type of sums of squares for ANOVA. Allowed values are either
1, 2 or 3. <code>type = 2</code> is the default because this will yield identical
ANOVA results as type = 1 when data are balanced but type = 2 will
additionally yield various assumption tests where appropriate. When the data
are unbalanced the <code>type = 3</code> is used by popular commercial softwares
including SPSS.</p></dd>


<dt>effect.size</dt>
<dd><p>the effect size to compute and to show in the ANOVA
results. Allowed values can be either "ges" (generalized eta squared) or
"pes" (partial eta squared) or both. Default is "ges".</p></dd>


<dt>error</dt>
<dd><p>(optional) for a linear model, an lm model object from which the
overall error sum of squares and degrees of freedom are to be calculated.
Read more in <code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a>()</code> documentation.</p></dd>


<dt>white.adjust</dt>
<dd><p>Default is FALSE. If TRUE, heteroscedasticity correction
is applied to the coefficient of covariance matrix. Used only for
independent measures ANOVA.</p></dd>


<dt>observed</dt>
<dd><p>Variables that are observed (i.e, measured) as compared to
experimentally manipulated. The default effect size reported (generalized
eta-squared) requires correct specification of the observed variables.</p></dd>


<dt>detailed</dt>
<dd><p>If TRUE, returns extra information (sums of squares columns,
intercept row, etc.) in the ANOVA table.</p></dd>


<dt>x</dt>
<dd><p>an object of class <code>anova_test</code></p></dd>


<dt>correction</dt>
<dd><p>character. Used only in repeated measures ANOVA test to
specify which correction of the degrees of freedom should be reported for
the within-subject factors. Possible values are:</p><ul><li><p>"GG":
applies Greenhouse-Geisser correction to all within-subjects factors even if
the assumption of sphericity is met (i.e., Mauchly's test is not
significant, p &gt; 0.05).</p></li>
<li><p>"HF": applies Hyunh-Feldt correction to all
within-subjects factors even if the assumption of sphericity is met,</p></li>
<li><p>"none": returns the ANOVA table without any correction and</p></li>
<li><p>"auto": apply automatically GG correction to only within-subjects
factors violating the sphericity assumption (i.e., Mauchly's test p-value is
significant, p &lt;= 0.05).</p></li>
</ul></dd>


<dt>...</dt>
<dd><p>additional arguments</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>return an object of class <code>anova_test</code> a data frame containing
 the ANOVA table for independent measures ANOVA.</p>


<p>However, for repeated/mixed measures ANOVA, a list containing the following
 components are returned: ANOVA table, Mauchly's Test for Sphericity,
 Sphericity Corrections. These table are described more in the documentation
 of the function <code><a href="anova_summary.html">anova_summary</a>()</code>.</p>


<p>The <strong>returned object has an attribute</strong> called <code>args</code>, which is a
 list holding the arguments used to fit the ANOVA model, including: data, dv,
 within, between, type, model, etc.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The setting in <code>anova_test()</code> is done in such a way that it
 gives the same results as SPSS, one of the most used commercial software. By
 default, R uses treatment contrasts, where each of the levels is compared to
 the first level used as baseline. The default contrast can be checked using
 <code>options('contrasts')</code>. In the function <code>anova_test()</code>, the
 following setting is used
 <code>options(contrasts=c('contr.sum','contr.poly'))</code>, which gives
 orthogonal contrasts where you compare every level to the overall mean. This
 setting gives the same output as the most commonly used commercial
 softwares, like SPSS. If you want to obtain the same result with the
 function <code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">car::Anova()</a></code> as the one obtained with
 <code>rstatix::anova_test()</code>, then don't forget to set
 <code>options(contrasts=c('contr.sum','contr.poly'))</code>.</p>
    </div>
    <div id="functions">
    <h2>Functions</h2>
    
<ul><li><p><code>anova_test()</code>: perform anova test</p></li>
<li><p><code>get_anova_table()</code>: extract anova table from an object of class
<code>anova_test</code>. When within-subject factors are present, either
sphericity corrected or uncorrected degrees of freedom can be reported.</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="anova_summary.html">anova_summary</a>()</code>, <code><a href="factorial_design.html">factorial_design</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Alboukadel Kassambara, <a href="mailto:alboukadel.kassambara@gmail.com">alboukadel.kassambara@gmail.com</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load data</span></span></span>
<span class="r-in"><span><span class="co">#:::::::::::::::::::::::::::::::::::::::</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ToothGrowth"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">ToothGrowth</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># One-way ANOVA test</span></span></span>
<span class="r-in"><span><span class="co">#:::::::::::::::::::::::::::::::::::::::::</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu">anova_test</span><span class="op">(</span><span class="va">len</span> <span class="op">~</span> <span class="va">dose</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ANOVA Table (type II tests)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Effect DFn DFd       F        p p&lt;.05   ges</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   dose   1  58 105.065 1.23e-14     * 0.644</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Grouped One-way ANOVA test</span></span></span>
<span class="r-in"><span><span class="co">#:::::::::::::::::::::::::::::::::::::::::</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">supp</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">anova_test</span><span class="op">(</span><span class="va">len</span> <span class="op">~</span> <span class="va">dose</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   supp  Effect   DFn   DFd     F        p `p&lt;.05`   ges</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> OJ    dose       1    28  36.0 1.82<span style="color: #949494;">e</span><span style="color: #BB0000;">- 6</span> *       0.563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> VC    dose       1    28 118.  1.51<span style="color: #949494;">e</span><span style="color: #BB0000;">-11</span> *       0.808</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Two-way ANOVA test</span></span></span>
<span class="r-in"><span><span class="co">#:::::::::::::::::::::::::::::::::::::::::</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu">anova_test</span><span class="op">(</span><span class="va">len</span> <span class="op">~</span> <span class="va">supp</span><span class="op">*</span><span class="va">dose</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ANOVA Table (type II tests)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Effect DFn DFd       F        p p&lt;.05   ges</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      supp   1  56  12.317 8.94e-04     * 0.180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      dose   1  56 133.415 1.91e-16     * 0.704</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 supp:dose   1  56   5.333 2.50e-02     * 0.087</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Two-way repeated measures ANOVA</span></span></span>
<span class="r-in"><span><span class="co">#:::::::::::::::::::::::::::::::::::::::::</span></span></span>
<span class="r-in"><span><span class="va">df</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">6</span><span class="op">)</span> <span class="co"># Add individuals id</span></span></span>
<span class="r-in"><span><span class="co"># Use formula</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu">anova_test</span><span class="op">(</span><span class="va">len</span> <span class="op">~</span> <span class="va">supp</span><span class="op">*</span><span class="va">dose</span> <span class="op">+</span> <span class="fu">Error</span><span class="op">(</span><span class="va">id</span><span class="op">/</span><span class="op">(</span><span class="va">supp</span><span class="op">*</span><span class="va">dose</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ANOVA Table (type III tests)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ANOVA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Effect DFn DFd       F        p p&lt;.05   ges</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      supp   1   9  34.866 2.28e-04     * 0.224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      dose   2  18 106.470 1.06e-10     * 0.773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 supp:dose   2  18   2.534 1.07e-01       0.132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Mauchly's Test for Sphericity`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Effect     W     p p&lt;.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      dose 0.807 0.425      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 supp:dose 0.934 0.761      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Sphericity Corrections`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Effect   GGe      DF[GG]    p[GG] p[GG]&lt;.05   HFe      DF[HF]    p[HF]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      dose 0.838 1.68, 15.09 2.79e-09         * 1.008 2.02, 18.15 1.06e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 supp:dose 0.938 1.88, 16.88 1.12e-01           1.176 2.35, 21.17 1.07e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   p[HF]&lt;.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># or use character vector</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu">anova_test</span><span class="op">(</span>dv <span class="op">=</span> <span class="va">len</span>, wid <span class="op">=</span> <span class="va">id</span>, within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">supp</span>, <span class="va">dose</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ANOVA Table (type III tests)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ANOVA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Effect DFn DFd       F        p p&lt;.05   ges</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      supp   1   9  34.866 2.28e-04     * 0.224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      dose   2  18 106.470 1.06e-10     * 0.773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 supp:dose   2  18   2.534 1.07e-01       0.132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Mauchly's Test for Sphericity`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Effect     W     p p&lt;.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      dose 0.807 0.425      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 supp:dose 0.934 0.761      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Sphericity Corrections`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Effect   GGe      DF[GG]    p[GG] p[GG]&lt;.05   HFe      DF[HF]    p[HF]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      dose 0.838 1.68, 15.09 2.79e-09         * 1.008 2.02, 18.15 1.06e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 supp:dose 0.938 1.88, 16.88 1.12e-01           1.176 2.35, 21.17 1.07e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   p[HF]&lt;.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract ANOVA table and apply correction</span></span></span>
<span class="r-in"><span><span class="co">#:::::::::::::::::::::::::::::::::::::::::</span></span></span>
<span class="r-in"><span><span class="va">res.aov</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu">anova_test</span><span class="op">(</span>dv <span class="op">=</span> <span class="va">len</span>, wid <span class="op">=</span> <span class="va">id</span>, within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">supp</span>, <span class="va">dose</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">get_anova_table</span><span class="op">(</span><span class="va">res.aov</span>, correction <span class="op">=</span> <span class="st">"GG"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ANOVA Table (type III tests)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Effect  DFn   DFd       F        p p&lt;.05   ges</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      supp 1.00  9.00  34.866 2.28e-04     * 0.224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      dose 1.68 15.09 106.470 2.79e-09     * 0.773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 supp:dose 1.88 16.88   2.534 1.12e-01       0.132</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use model as arguments</span></span></span>
<span class="r-in"><span><span class="co">#:::::::::::::::::::::::::::::::::::::::::</span></span></span>
<span class="r-in"><span><span class="va">.my.model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">block</span> <span class="op">+</span> <span class="va">N</span><span class="op">*</span><span class="va">P</span><span class="op">*</span><span class="va">K</span>, <span class="va">npk</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">anova_test</span><span class="op">(</span><span class="va">.my.model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ANOVA Table (type II tests)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Effect DFn DFd      F     p p&lt;.05   ges</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  block   4  12  4.959 0.014     * 0.623</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      N   1  12 12.259 0.004     * 0.505</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      P   1  12  0.544 0.475       0.043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      K   1  12  6.166 0.029     * 0.339</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    N:P   1  12  1.378 0.263       0.103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    N:K   1  12  2.146 0.169       0.152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    P:K   1  12  0.031 0.863       0.003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  N:P:K   0  12     NA    NA  &lt;NA&gt;    NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alboukadel Kassambara.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

